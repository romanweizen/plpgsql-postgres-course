## üìò `06_interview_questions.md`

# –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é –ø–æ PostgreSQL –∏ PL/pgSQL

---

## üß≠ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

* [1. –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ PostgreSQL](#1-–æ–±—â–∏–µ-–≤–æ–ø—Ä–æ—Å—ã-–ø–æ-postgresql)
* [2. PL/pgSQL –∏ —Ñ—É–Ω–∫—Ü–∏–∏](#2-plpgsql-–∏-—Ñ—É–Ω–∫—Ü–∏–∏)
* [3. –¢—Ä–∏–≥–≥–µ—Ä—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ](#3-—Ç—Ä–∏–≥–≥–µ—Ä—ã-–∏-–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
* [4. JSONB –∏ –∞—É–¥–∏—Ç –¥–∞–Ω–Ω—ã—Ö](#4-jsonb-–∏-–∞—É–¥–∏—Ç-–¥–∞–Ω–Ω—ã—Ö)
* [5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#5-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
* [6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞](#6-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–∏-–∫–æ–Ω—Ç—Ä–æ–ª—å-–¥–æ—Å—Ç—É–ø–∞)
* [7. –°—Ü–µ–Ω–∞—Ä–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π](#7-—Å—Ü–µ–Ω–∞—Ä–∏–∏-—Å-—Ä–µ–∞–ª—å–Ω—ã—Ö-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π)

---

## 1. –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ PostgreSQL

**Q1:** –ß–µ–º PostgreSQL –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –¥—Ä—É–≥–∏—Ö –°–£–ë–î (MySQL, Oracle)?
**A:** PostgreSQL ‚Äî –æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, JSONB, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —É—Ä–æ–≤–Ω—è Serializable –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (PL/pgSQL, Python, C).

---

**Q2:** –ß—Ç–æ —Ç–∞–∫–æ–µ ACID –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ PostgreSQL —ç—Ç–∏ —Å–≤–æ–π—Å—Ç–≤–∞?
**A:** –î–∞.
ACID = Atomicity, Consistency, Isolation, Durability ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

---

**Q3:** –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?
**A:** PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **MVCC (Multiversion Concurrency Control)** ‚Äî –≤–º–µ—Å—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä–æ–∫; —á–∏—Ç–∞—Ç–µ–ª–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –ø–∏—Å–∞—Ç–µ–ª–µ–π –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

---

**Q4:** –ß—Ç–æ —Ç–∞–∫–æ–µ —Å—Ö–µ–º–∞ (schema)?
**A:** –≠—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–Ω—É—Ç—Ä–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —Ç–∞–±–ª–∏—Ü—ã, —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ê–Ω–∞–ª–æ–≥ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω.

---

**Q5:** –ö–∞–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –∏ —Ñ—É–Ω–∫—Ü–∏–π?

```sql
\dt        -- —Ç–∞–±–ª–∏—Ü—ã
\df        -- —Ñ—É–Ω–∫—Ü–∏–∏
```

–∏–ª–∏:

```sql
SELECT * FROM pg_tables;
SELECT * FROM pg_proc;
```

---

## 2. PL/pgSQL –∏ —Ñ—É–Ω–∫—Ü–∏–∏

**Q6:** –ß—Ç–æ —Ç–∞–∫–æ–µ PL/pgSQL?
**A:** –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ SQL, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —É—Å–ª–æ–≤–∏—è, —Ü–∏–∫–ª—ã, –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã.

---

**Q7:** –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è `LANGUAGE SQL` –æ—Ç `LANGUAGE plpgsql`?
**A:**

* `SQL` ‚Äî –ø—Ä–æ—Å—Ç–∞—è –æ–±—ë—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ SQL-–∑–∞–ø—Ä–æ—Å–∞ (–±–µ–∑ –ª–æ–≥–∏–∫–∏).
* `plpgsql` ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å —É—Å–ª–æ–≤–∏—è–º–∏, —Ü–∏–∫–ª–∞–º–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.

---

**Q8:** –ö–∞–∫ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ?

```sql
DECLARE
    counter INT := 0;
    name TEXT;
```

---

**Q9:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `PERFORM`?
**A:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–∞–Ω–∞–ª–æ–≥ `SELECT` –±–µ–∑ –≤—ã–≤–æ–¥–∞).

---

**Q10:** –ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –Ω–∞–±–æ—Ä —Å—Ç—Ä–æ–∫ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏?

```sql
RETURNS TABLE(...) AS $$
BEGIN
    RETURN QUERY SELECT ...;
END;
$$ LANGUAGE plpgsql;
```

---

**Q11:** –ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É –≤ PL/pgSQL?

```sql
BEGIN
    ...–∫–æ–¥...
EXCEPTION WHEN others THEN
    RAISE NOTICE '–û—à–∏–±–∫–∞: %', SQLERRM;
END;
```

---

**Q12:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `GET DIAGNOSTICS`?
**A:** –ü–æ–ª—É—á–∞–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ROW_COUNT` ‚Äî —á–∏—Å–ª–æ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Å—Ç—Ä–æ–∫).

---

## 3. –¢—Ä–∏–≥–≥–µ—Ä—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

**Q13:** –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç—Ä–∏–≥–≥–µ—Ä?
**A:** –ú–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏ (`INSERT`, `UPDATE`, `DELETE`, `TRUNCATE`).

---

**Q14:** –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `BEFORE` –∏ `AFTER` —Ç—Ä–∏–≥–≥–µ—Ä–æ–º?

| BEFORE                   | AFTER                  |
| ------------------------ | ---------------------- |
| –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è | –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ      |
| –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å `NEW`     | –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ |
| –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏   | –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞—É–¥–∏—Ç–∞    |

---

**Q15:** –ß—Ç–æ —Ç–∞–∫–æ–µ `NEW` –∏ `OLD`?

| –û–ø–µ—Ä–∞—Ü–∏—è | NEW                   | OLD           |
| -------- | --------------------- | ------------- |
| INSERT   | —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É | NULL          |
| UPDATE   | –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å—Ç—Ä–æ–∫–∏   | —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è |
| DELETE   | NULL                  | —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è |

---

**Q16:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TG_OP`?
**A:** –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏, –≤—ã–∑–≤–∞–≤—à–µ–π —Ç—Ä–∏–≥–≥–µ—Ä (`INSERT`, `UPDATE`, `DELETE`).

---

**Q17:** –ö–∞–∫ –≤ —Ç—Ä–∏–≥–≥–µ—Ä–µ —É–∑–Ω–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É, –≥–¥–µ —Å—Ä–∞–±–æ—Ç–∞–ª —Ç—Ä–∏–≥–≥–µ—Ä?
**A:** –ß–µ—Ä–µ–∑ `TG_TABLE_NAME`.

---

**Q18:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `RETURN NEW` –∏ `RETURN OLD`?
**A:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–∞ –≤ —Ç–∞–±–ª–∏—Ü—É (`NEW` ‚Äî –Ω–æ–≤–∞—è, `OLD` ‚Äî —Å—Ç–∞—Ä–∞—è).

---

**Q19:** –ú–æ–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä –Ω–∞ `SELECT`?
**A:** –ù–µ—Ç, —Ç—Ä–∏–≥–≥–µ—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è.

---

## 4. JSONB –∏ –∞—É–¥–∏—Ç –¥–∞–Ω–Ω—ã—Ö

**Q20:** –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è `JSON` –æ—Ç `JSONB`?

| JSON                 | JSONB                       |
| -------------------- | --------------------------- |
| —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç   | —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ |
| –º–µ–¥–ª–µ–Ω–Ω–µ–µ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ | –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤        |
| —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞     | –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø–æ –∫–ª—é—á–∞–º     |

---

**Q21:** –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ JSONB?

```sql
SELECT data->>'email' FROM users;
```

---

**Q22:** –ö–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–≤–∞ JSONB?

```sql
SELECT '{"a":1}'::jsonb || '{"b":2}'::jsonb;
```

üü¢ –†–µ–∑—É–ª—å—Ç–∞—Ç: `{"a":1,"b":2}`

---

**Q23:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä `-` –¥–ª—è JSONB?

```sql
SELECT '{"a":1,"b":2}'::jsonb - 'a';
```

üü¢ –£–¥–∞–ª—è–µ—Ç –∫–ª—é—á `"a"`.

---

**Q24:** –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—è –º–µ–∂–¥—É OLD –∏ NEW?

```sql
SELECT jsonb_object_agg(key, value)
FROM jsonb_each(to_jsonb(NEW))
WHERE (to_jsonb(OLD)->key) IS DISTINCT FROM value;
```

---

**Q25:** –ü–æ—á–µ–º—É `IS DISTINCT FROM` –ª—É—á—à–µ, —á–µ–º `!=`?
**A:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `NULL`, –Ω–µ –≤—ã–∑—ã–≤–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏.

---

**Q26:** –ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ JSONB?
**A:** –ß–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É –∞—É–¥–∏—Ç–∞ —Å –ø–æ–ª—è–º–∏ `old_data JSONB`, `new_data JSONB`, `operation`, `user_name`, `changed_at`.

---

**Q27:** –ö–∞–∫ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö —Å—Ä–∞–∑—É?
**A:** –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é-—Ç—Ä–∏–≥–≥–µ—Ä —Å `TG_TABLE_NAME`, `TG_OP`, `to_jsonb(OLD)`, `to_jsonb(NEW)` –∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –µ—ë –∫ –Ω—É–∂–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º.

---

## 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**Q28:** –ß—Ç–æ —Ç–∞–∫–æ–µ MVCC –∏ –∑–∞—á–µ–º –æ–Ω–æ –Ω—É–∂–Ω–æ?
**A:** *Multiversion Concurrency Control* ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –º–Ω–æ–≥–æ–≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤–∏–¥–∏—Ç ‚Äú—Å–≤–æ—ë‚Äù —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

---

**Q29:** –ß—Ç–æ —Ç–∞–∫–æ–µ VACUUM –∏ ANALYZE?

| –ö–æ–º–∞–Ω–¥–∞   | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                      |
| --------- | ----------------------------------------------- |
| `VACUUM`  | —É–¥–∞–ª—è–µ—Ç ‚Äú–º–µ—Ä—Ç–≤—ã–µ‚Äù –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |
| `ANALYZE` | –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞           |

---

**Q30:** –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –ø–æ –∫–ª—é—á—É –≤–Ω—É—Ç—Ä–∏ JSONB?

```sql
CREATE INDEX idx_users_email_jsonb ON users USING gin ((data->>'email'));
```

---

**Q31:** –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ –º–∞—Å—Å–æ–≤—ã—Ö —É–¥–∞–ª–µ–Ω–∏–π?
**A:** –í—ã–ø–æ–ª–Ω–∏—Ç—å `VACUUM FULL table_name;`

---

**Q32:** –ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –≤—Å—Ç–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö?

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COPY FROM` –≤–º–µ—Å—Ç–æ `INSERT`.
* –û—Ç–∫–ª—é—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤—Ä–µ–º—è –≤—Å—Ç–∞–≤–∫–∏.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

---

## 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

**Q33:** –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–æ–ª–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏?
**A:** PostgreSQL —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞–º–∏ —á–µ—Ä–µ–∑ —Ä–æ–ª–∏ (`CREATE ROLE`, `GRANT`, `REVOKE`).

---

**Q34:** –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º?

```sql
REVOKE ALL ON FUNCTION my_func FROM PUBLIC;
GRANT EXECUTE ON FUNCTION my_func TO manager;
```

---

**Q35:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç SECURITY DEFINER?
**A:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –∏–º–µ–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞, –∞ –Ω–µ –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

**Q36:** –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –∞—É–¥–∏—Ç–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π?

```sql
REVOKE INSERT, UPDATE, DELETE ON audit_log FROM PUBLIC;
GRANT SELECT ON audit_log TO analyst;
```

---

**Q37:** –ß—Ç–æ —Ç–∞–∫–æ–µ row-level security (RLS)?
**A:** –ú–µ—Ö–∞–Ω–∏–∑–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å—Ç—Ä–æ–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã.
–ü—Ä–∏–º–µ—Ä:

```sql
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
CREATE POLICY user_policy ON users
FOR SELECT USING (current_user = owner);
```

---

## 7. –°—Ü–µ–Ω–∞—Ä–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π

---

### üß† –í–æ–ø—Ä–æ—Å:

‚Äú–û–ø–∏—à–∏, –∫–∞–∫ –±—ã —Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ —Å–∏—Å—Ç–µ–º–µ, —á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥.‚Äù

**–û—Ç–≤–µ—Ç:**
–°–æ–∑–¥–∞—é –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É `audit_log` —Å `table_name`, `operation`, `old_data`, `new_data`, `user_name`, `changed_at`.
–ü–∏—à—É –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é `audit_all()`, –∏—Å–ø–æ–ª—å–∑—É—é—â—É—é `TG_OP`, `TG_TABLE_NAME`, `to_jsonb(OLD)`, `to_jsonb(NEW)`.
–≠—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é –∫–æ –≤—Å–µ–º –Ω—É–∂–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º —á–µ—Ä–µ–∑ `CREATE TRIGGER ... EXECUTE FUNCTION audit_all()`.

---

### üß† –í–æ–ø—Ä–æ—Å:

‚Äú–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –ø–æ–º–µ–Ω—è–ª–æ—Å—å)?‚Äù

**–û—Ç–≤–µ—Ç:**
–î–æ–±–∞–≤–ª—è—é –ø—Ä–æ–≤–µ—Ä–∫—É:

```sql
WHEN (OLD IS DISTINCT FROM NEW)
```

–∏–ª–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏:

```sql
IF to_jsonb(OLD) IS DISTINCT FROM to_jsonb(NEW) THEN
    INSERT INTO audit_log ...
END IF;
```

---

### üß† –í–æ–ø—Ä–æ—Å:

‚Äú–ö–∞–∫ –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ –ø–µ—Ä–∏–æ–¥?‚Äù

**–û—Ç–≤–µ—Ç:**

```sql
SELECT * FROM audit_log
WHERE user_name = 'admin'
AND changed_at BETWEEN '2025-01-01' AND '2025-12-31';
```

---

### üß† –í–æ–ø—Ä–æ—Å:

‚Äú–ö–∞–∫ –±—ã —Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª soft delete (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)?‚Äù

**–û—Ç–≤–µ—Ç:**
–î–æ–±–∞–≤–ª—è—é –∫–æ–ª–æ–Ω–∫—É `deleted_at TIMESTAMP`.
–í–º–µ—Å—Ç–æ `DELETE` ‚Äî –¥–µ–ª–∞—é `UPDATE ... SET deleted_at = NOW()`.
–°–æ–∑–¥–∞—é `BEFORE DELETE` —Ç—Ä–∏–≥–≥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–º–µ–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é:

```sql
CREATE OR REPLACE FUNCTION soft_delete()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE users SET deleted_at = NOW() WHERE id = OLD.id;
    RETURN NULL; -- –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
END;
$$ LANGUAGE plpgsql;
```

---

### üß† –í–æ–ø—Ä–æ—Å:

‚Äú–ö–∞–∫ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å JSONB-–∞—É–¥–∏—Ç PostgreSQL —Å ClickHouse?‚Äù

**–û—Ç–≤–µ—Ç:**

* –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é `LISTEN/NOTIFY` –∏–ª–∏ `logical replication` —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π `audit_log`;
* –≤–æ –≤–Ω–µ—à–Ω–µ–º ETL-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ (Debezium, Airbyte) —á–∏—Ç–∞—é JSONB –∏ —Å–æ—Ö—Ä–∞–Ω—è—é –≤ ClickHouse;
* ClickHouse –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

‚úÖ –ü–æ—Å–ª–µ —ç—Ç–æ–π –≥–ª–∞–≤—ã —Ç—ã:

* –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é –ø–æ PostgreSQL, PL/pgSQL, JSONB –∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º;
* –ø–æ–Ω–∏–º–∞–µ—à—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∞—É–¥–∏—Ç–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏;
* —É–º–µ–µ—à—å –æ–±—ä—è—Å–Ω–∏—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–¥ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö.

---
